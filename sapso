def calculate_diversity_and_dir(swarm,dir_):
  """  Calculates the diversity factor, 
       which may be -1 (repulsion phase) or 1 (attraction phase)
  """
  mean = np.mean(swarm, axis=0)
  summ = 0
  for k in range(n):
    summ += np.sqrt( np.sum( swarm[k] - mean ) **2 )
  diversity = 1./(n*L) * summ
  
  if diversity < d_low:
    dir_ = -1
  elif diversity > d_high:
    dir_ = 1
  
  return diversity, dir_